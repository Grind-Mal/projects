name: Validate Project Issue

on:
  issues:
    types: [opened]

jobs:
  validate:
    runs-on: ubuntu-latest
    steps:
      # Checkout repo if needed
      - name: Checkout repo
        uses: actions/checkout@v4

      # Validate issue using GitHub Script
      - name: Validate Project Issue
        uses: actions/github-script@v7
        with:
          github-token: ${{ secrets.PAT_TOKEN }} # <-- Use your PAT token here
          script: |
            const body = context.payload.issue.body || "";

            const required = [
              "Project Description",
              "Repository URL",
              "What are you stuck on"
            ];

            const missing = required.filter(r => !body.includes(r));

            if (missing.length) {
              await github.rest.issues.createComment({
                owner: context.repo.owner,
                repo: context.repo.repo,
                issue_number: context.payload.issue.number,
                body: `âŒ Missing sections:\n${missing.map(m => `- ${m}`).join("\n")}`
              });
              core.setFailed("Invalid submission");
            }
